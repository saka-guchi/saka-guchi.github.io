# ラブラドール学習帳 仕様書

**バージョン:** 51.1
**ターゲット:** Web / PWA
**アーキテクチャ:** マルチページアプリケーション (MPA) / 静的ホスティング

## 1. ファイル構成
- `index.html`: ホーム画面（エントリポイント）
- `quiz.html`: クイズ画面
- `priming.html`: 事前学習画面
- `result.html`: 結果画面
- `list.html`: 単語一覧画面
- `settings.html`: 詳細設定画面
- `style.css`: 共通スタイル
- `app.js`: 共通ロジック（データ読み込み、SRS、セッション管理）
- `words.csv`: 学習データソース（初回読み込み時のみ使用）
- `Dog.json`: Lottieアニメーションデータ

## 2. データ管理
- **マスターデータ**: `localStorage` (キー: `lab_data_v30`)
- **初回ロード**: `words.csv` をフェッチし、空であれば `localStorage` を初期化。
- **永続化**: すべての進捗は `localStorage` に保存される。
- **セッション**: `sessionStorage` を使用して、クイズキューと結果をページ間で受け渡す。

## 3. UI/UX 仕様

### 3.1 共通デザイン
- **ヘッダー**: 画面タイトル（左） + ホームボタン（右、アイコンのみ）。
- **フッター**: 全画面共通で、画面下部に「ホームへ戻る」等のボタンを配置。
- **テーマカラー**: #F4D03F (プライマリ), #5D4037 (テキスト), #FAF9F6 (背景)。
  - ホーム画面の背景色はテーマカラー（#F4D03F）を使用。

### 3.2 ホーム画面 (`index.html`)
- **ヘッダー**: 「ラブラドール学習帳」（絵文字なし）。
- **ビジュアル**:
  - メッセージ「単語を覚えると仲良くなれるよ」。
  - Lottieアニメーション (`Dog.json`) + 親密度ハートメーター（10個）。
- **グラフ**: 「記憶できる期間」の分布表示。
  - タイトルをクリックするとレベル別の出題形式の説明を表示。
  - Lv.5のラベルは「1ヶ月後」。
- **設定**: モード（復習/新規）、出題数（10/20）、事前学習（ON/OFF）。
- **デバッグ機能**: 親密度（ハート）を増減できるボタンを表示。
- **バージョン情報**: フッター最下部に表示。

### 3.3 単語一覧画面 (`list.html`)
- **タイトル**: 「全単語一覧」。
- **リスト表示**: [品詞] 英単語 / 意味 をカード形式で表示。

### 3.4 クイズ画面 (`quiz.html`)
- **ヘッダー**: プログレスバー（上部）、進捗状況（左）、現在のレベル（右）。
- **カードレイアウト**: 英単語（上） + 品詞バッジ（下/小）。縦並び。
- **機能**:
  - マスク機能（目のアイコン）。
  - 音声再生（スピーカーアイコン）。
  - 中断ボタン（確認ダイアログ表示後にホームへ）。
  - 連打防止機能（回答処理中のクリック無効化）。

### 3.5 結果画面 (`result.html`)
- **レイアウト**:
  - 上部: 「記憶定着期間の変動」グラフを表示（前回からの変動を +/- で強調表示）。
  - 中央: 結果リスト（スクロール可能）。
  - 下部: 「もう一度」ボタン + 「ホームへ戻る」ボタン（サイズ統一）。

## 4. ロジック仕様

### 4.1 アダプティブクイズ (レベル別出題)
- **Lv.0-1 (Standard)**: 英単語 -> 日本語（マスクなし）。
- **Lv.2 (Masked)**: マスクされた英単語 -> 日本語。
- **Lv.3 (Reverse)**: 日本語 -> 英単語。
- **Lv.4+ (Fill-in)**: 穴埋め問題。

### 4.2 SRS (間隔反復) アルゴリズム
- **正解**: レベルアップ（最大5）、復習間隔の延長。
- **不正解**: レベルリセット（0）、復習間隔を1日にリセット。

### 4.3 親密度 (Affinity) システム
- 全単語の合計レベルに基づいて算出。
- 10個のハートと犬の反応（バブルメッセージ）で可視化。